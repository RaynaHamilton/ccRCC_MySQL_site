renal<-read.table("Renal_GSE53757.csv",sep=",",header=T,row.names=1)
library("hgu95av2.db")
BiocManager::install("hgu95av2.db")
library("AnnotationDbi")
library("org.Hs.eg.db")
View(renal)
renal
colnames(renal)
map<-mapIds(org.Hs.eg.db,keys=colnames(renal),"ENTREZID","SYMBOL")
keys()
?mapIDs()
?mapIds()
map<-mapIds(org.Hs.eg.db,keys=keys(),"ENTREZID","SYMBOL")
?mapIds
keys
keys()
?keys
library("EnrichmentBrowser")
map<-mapIds(org.Hs.eg.db,keys=colnames(renal),"PROBEID","SYMBOL")
columns
columns()
columns(colnames(renal))
keys(colnames(renal))
?select
BiocManager::install("annoGene")
install.packages("annoGene")
biocLite("hgu95av2.db")
source("http://bioconductor.org/biocLite.R")
library("hgu95av2.db")
map<-mapIds(org.Hs.eg.db,keys=colnames(renal),"PROBEID","SYMBOL")
genes <- select(hgu95av2.db,keys= PROBES, columns=c("SYMBOL", "ENTREZID", "GENENAME"),keytype="UNIGENE")
genes <- select(hgu95av2.db,keys=colnames(renal), columns=c("SYMBOL", "ENTREZID", "GENENAME"),keytype="UNIGENE")
genes <- select(hgu95av2.db,keys=colnames(renal), columns=c("SYMBOL", "ENTREZID", "GENENAME"),keytype="PROBEID")
colnames(renal)
genes <- select(hgu95av2.db,keys=probes, columns=c("SYMBOL", "ENTREZID", "GENENAME"),keytype="PROBEID")
probes<-as.character(colnames(renal))
genes <- select(hgu95av2.db,keys=probes, columns=c("SYMBOL", "ENTREZID", "GENENAME"),keytype="PROBEID")
keytypes(probes)
keytypes(hgu95av2.db)
genes <- select(hgu95av2.db,keys=probes, columns=c("SYMBOL", "ENTREZID", "GENENAME"),keytype="SYMBOL")
keytypes(org.Hs.eg.db)
library("hgu133plus2.db")
BiocManager::install("hgu133plus2.db")
library("hgu133plus2.db")
genes <- select(hgu133plus2.db,keys=probes, columns=c("SYMBOL", "ENTREZID", "GENENAME"),keytype="SYMBOL")
genes <- select(hgu133plus2.db,keys=probes, columns=c("SYMBOL", "ENTREZID", "GENENAME"),keytype="PROBEID")
keytypes(hgu133plus2.db)
hgu133plus2.db
renal_raw<-read.table("GSE53757_series_matrix.txt",header=T,row.names=1)
renal_raw<-read.table("GSE53757_series_matrix.txt",header=T,row.names=1)
rownames(renal_raw)
colnames(renal)
temp<-cbind(colnames(renal),rownames(renal_raw))
temp<-cbind(c(colnames(renal),rownames(renal_raw)))
temp
temp<-rbind(c(colnames(renal),rownames(renal_raw)))
temp
temp<-cbind(c(data.frame(colnames(renal)),rownames(renal_raw)))
temp
temp<-cbind(c(data.frame(colnames(renal)),data.frame(rownames(renal_raw))))
temp
View(temp)
View(temp)
colnames(renal)
rownames(renal_raw)
substr(colnames(renal),1,50)
substr(colnames(renal),2,50)
intersect(substr(colnames(renal),2,50),renal_raw)
substr(colnames(renal),2,50)==renal_raw
substr(colnames(renal),2,50)==rownames(renal_raw)
genes <- select(hgu133plus2.db,keys=substr(probes,2,50), columns=c("SYMBOL", "ENTREZID", "GENENAME"),keytype="PROBEID")
genes
genes <- select(hgu133plus2.db,keys=substr(probes,2,50), columns=c("SYMBOL", "GENENAME"),keytype="PROBEID")
genes
?write.table
keytypes(hgu133plus2.db)
genes <- select(hgu133plus2.db,keys=substr(probes,2,50), columns=c("SYMBOL", "GENENAME","ENTREZID","GO"),keytype="PROBEID")
genes
genes <- select(hgu133plus2.db,keys=substr(probes,2,50), columns=c("SYMBOL", "GENENAME","ENTREZID","GO","GOALL"),keytype="PROBEID")
BiocManager::install("GO.db")
library("GOdb")
library("GO.db")
genes <- select(hgu133plus2.db,keys=substr(probes,2,50), columns=c("SYMBOL", "GENENAME","ENTREZID","GO"),keytype="PROBEID")
genes$GO
Term(genes$GO)
go_terms<-unique(genes$GO)
go_terms
Term(go_terms)
go_terms<-Term(go_terms)
genes
genes <- select(hgu133plus2.db,keys=substr(probes,2,50), columns=c("SYMBOL", "GENENAME","ENTREZID"),keytype="PROBEID")
go_terms<-select(hgu133plus2.db,keys=substr(probes,2,50), columns=c("GO"),keytype="PROBEID")
go_terms
go_names<-Term(unique(go_terms$GO))
go_names
View(renal_raw)
go_names
genes
write.table(genes,file="probes_to_names.tsv",quote=F,row.names=F)
View(go_terms)
go_terms[c("PROBEID","GO")]
write.table(go_terms[c("PROBEID","GO")],"probes_to_GO.tsv",quote=F,row.names=F)
write.table(go_names,"GO_to_names.tsv",quote=F,row.names=F)
data.frame(go_names)
names(go_names)
cbind(c(names(go_names)),go_names)
go_names<-cbind(c(names(go_names)),go_names)
write.table(go_names,"GO_to_names.tsv",quote=F,row.names=F)
renal
renal[1]
renal[2]
View(genes)
unique(genes$SYMBOL)
len(unique(genes$SYMBOL))
length(unique(genes$SYMBOL))
length(genes$SYMBOL)
length(unique(genes$ENTREZID ))
View(renal)
renal<-read.table("data/Renal_GSE53757.csv",sep=",",header=T,row.names=1)
corr(renal)
?corr
??Corr
??corr
library("ggpubr")
cor(renal)
renal<-renal[,colnames(renal)!="type"]
renal
cor(renal)
View(renal)
library("hgu133plus2.db")
#we will write seprate files for probe ids to gene names, probe ids to GO terms
#and GO terms to GO descriptions to avoid storing lots of wasteful redundant data
#this is similar to how our database will be structured!
probes<-as.character(colnames(renal))
genes <- select(hgu133plus2.db,keys=substr(probes,2,50), columns=c("SYMBOL", "GENENAME","ENTREZID"),keytype="PROBEID")
write.table(genes,file="../data/probes_to_genes.tsv",quote=F,row.names=F)
library("GO.db")
go_terms<-select(hgu133plus2.db,keys=unique(genes$SYMBOL), columns=c("GO"),keytype="SYMBOL")
temp<-unique(go_terms$)
write.table(go_terms[c("SYMBOL","GO")],"../data/genes_to_GO.tsv",quote=F,row.names=F)
go_names<-Term(unique(go_terms$GO))
go_names<-cbind(c(names(go_names)),go_names)
write.table(go_names,"../data/GO_to_names.tsv",quote=F,row.names=F)
go_names
write.table(genes,file="../data/probes_to_genes.tsv",quote=F,row.names=F)
go_terms<-select(hgu133plus2.db,keys=unique(genes$SYMBOL), columns=c("GO"),keytype="SYMBOL")
go_terms
write.table(go_terms[,c("SYMBOL","GO")],"../data/genes_to_GO.tsv",quote=F,row.names=F)
go_names<-Term(unique(go_terms$GO))
go_names<-cbind(c(names(go_names)),go_names)
write.table(go_names,"../data/GO_to_names.tsv",quote=F,row.names=F)
View(genes)
print(paste(unique(genes$PROBEID),unique(genes$SYMBOL),unique(genes$GENENAME)))
print(paste(length(unique(genes$PROBEID)),length(unique(genes$SYMBOL)),length(unique(genes$GENENAME))))
View(go_names)
print(paste(length(unique(go_names$V1)),length(unique(go_names$go_names))))
print(paste(length(unique(go_names["V1",])),length(unique(go_names$go_names))))
print(paste(length(unique(go_names["V1"])),length(unique(go_names$go_names))))
print(paste(length(unique(go_names["V1"])),length(unique(go_names["go_names"]))))
go_names
View(go_terms)
go_names$V1
go_names
go_names<-data.frame(go_names)
print(paste(length(unique(go_names$V1)),length(unique(go_names$go_names))))
print(paste(length(unique(genes$PROBEID)),length(unique(genes$SYMBOL)),length(unique(genes$GENENAME))))
table(genes$PROBEID)
table(genes$PROBEID)[tables(genes$PROBEID)>1]
table(genes$PROBEID)[table(genes$PROBEID)>1]
names(table(genes$PROBEID)>1)
names(table(genes$PROBEID)[table(genes$PROBEID)>1])
temp<-genes[genes$PROBEID %in% names(table(genes$PROBEID)[table(genes$PROBEID)>1]),]
temp
View(temp)
length(unique(temp$PROBEID))
print(paste(length(unique(genes$PROBEID)),length(unique(genes$SYMBOL)),length(unique(genes$GENENAME))))
print(paste(length(unique(go_names$V1)),length(unique(go_names$go_names))))
?write.table
write.table(genes,file="../data/probes_to_genes.tsv",quote=F,row.names=F,sep="/t")
go_terms<-select(hgu133plus2.db,keys=unique(genes$SYMBOL), columns=c("GO"),keytype="SYMBOL")
write.table(go_terms[,c("SYMBOL","GO")],"../data/genes_to_GO.tsv",quote=F,row.names=F,sep="/t")
write.table(go_names,"../data/GO_to_names.tsv",quote=F,row.names=F,sep="/t")
write.table(genes,file="../data/probes_to_genes.tsv",quote=F,row.names=F,sep="\t")
write.table(go_terms[,c("SYMBOL","GO")],"../data/genes_to_GO.tsv",quote=F,row.names=F,sep="\t")
write.table(go_names,"../data/GO_to_names.tsv",quote=F,row.names=F,sep="\t")
raw<-read.table("../data/GSE53757_series_matrix.txt")
View(raw)
View(renal_raw)
hist(raw["1007_s_at",])
hist(as.numeric(raw["1007_s_at",]))
hist(as.numeric(raw["1007_s_at",]),breaks=300)
raw["1007_s_at",]
raw[,"1007_s_at"]
renal_raw[,"1007_s_at"]
renal_raw["1007_s_at",]
hist(as.numeric(renal_raw["1007_s_at",]),breaks=300)
hist(as.numeric(renal["1007_s_at",]),breaks=300)
View(renal)
renal
ls
colnames(renal)
rownames(renal)
renal<-read.table("../data/Renal_GSE53757.csv",sep=",",header=T,row.names=1)
View(raw)
View(renal)
renal
View(renal)
renal$class
renal<-read.table("../data/Renal_GSE53757.csv",sep=",",header=T,row.names=1)
write.table(genes,file="../data/probes_to_genes.tsv",row.names=F,quote=F,sep="\t")
write.table(go_terms[,c("SYMBOL","GO")],"../data/genes_to_GO.tsv",quote=F,row.names=F,sep="\t",header=F)
?write.table
write.table(go_terms[,c("SYMBOL","GO")],"../data/genes_to_GO.tsv",quote=F,row.names=F,sep="\t",col.names=F)
write.table(genes,file="../data/probes_to_genes.tsv",row.names=F,quote=F,sep="\t",col.names=F)
write.table(go_names,"../data/GO_to_names.tsv",quote=F,row.names=F,sep="\t",col.names=F)
write.table(change_results,file="../data/probes_to_stats.tsv",quote=F,sep="\t",col.names=F)
probes<-as.character(colnames(renal)[2:length(colnames(renal))])
temp<-probes
for (i in seq(length(probes))){
if ( substr(probes[i],1,1)=="X" ){
probes[i]=substr(probes[i],2,50)
}
}
probes[length(probes)]
genes <- select(hgu133plus2.db,keys=probes, columns=c("SYMBOL", "GENENAME","ENTREZID"),keytype="PROBEID")
library("AnnotationDbi")
library("hgu133plus2.db")
genes <- select(hgu133plus2.db,keys=probes, columns=c("SYMBOL", "GENENAME","ENTREZID"),keytype="PROBEID")
write.table(genes,file="../data/probes_to_genes.tsv",row.names=F,quote=F,sep="\t",col.names=F)
View(go_names)
apply
colnames(go_names)
apply(go_names$go_names,n_char)
apply(go_names$go_names,1,n_char)
apply(go_names$go_names,1,nchar)
sapply(go_names$go_names,nchar)
max(sapply(go_names$go_names,nchar))
max(sapply(go_names$go_names,nchar),na.rm=T)
